{% set table_a = 'ANALYTICS_RAW.POSTHOG._AIRBYTE_RAW_EVENTS' %}
{% set schema_l1 = [('properties.$geoip_continent_code', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], True), ('properties.$geoip_continent_name', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], True), ('properties.$geoip_country_code', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], True), ('properties.$geoip_country_name', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], True), ('properties.$geoip_latitude', ['INTEGER', 'DOUBLE', 'DECIMAL'], True), ('properties.$geoip_longitude', ['INTEGER', 'DOUBLE', 'DECIMAL'], True), ('properties.$geoip_time_zone', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], True), ('properties.$ip', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], True), ('properties.$plugins_deferred', ['ARRAY'], True), ('properties.$plugins_failed', ['ARRAY'], True), ('properties.$plugins_succeeded', ['ARRAY'], True), ('properties.start_date', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.direction', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.DELETE', ['INTEGER'], False), ('properties.$geoip_subdivision_1_name', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.success_queries', ['INTEGER'], False), ('properties.$geoip_subdivision_2_code', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.RENAME', ['INTEGER'], False), ('properties.$geoip_subdivision_1_code', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.ALTER_TABLE_DROP_COLUMN', ['INTEGER'], False), ('properties.$geoip_postal_code', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.ALTER_TABLE', ['INTEGER'], False), ('properties.CREATE_SEQUENCE', ['INTEGER'], False), ('properties.$set', ['OBJECT'], False), ('properties.version', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.dbt_installed', ['BOOLEAN'], False), ('properties.distinct_id', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.DROP_ROLE', ['INTEGER'], False), ('properties.ALTER_ACCOUNT', ['INTEGER'], False), ('properties.SCRIPT', ['INTEGER'], False), ('properties.SET', ['INTEGER'], False), ('properties.CREATE_USER', ['INTEGER'], False), ('properties.DROP_CONSTRAINT', ['INTEGER'], False), ('properties.CREATE_TASK', ['INTEGER'], False), ('properties.full_table_names', ['BOOLEAN'], False), ('properties.ALTER', ['INTEGER'], False), ('properties.GET_FILES', ['INTEGER'], False), ('properties.RENAME_TABLE', ['INTEGER'], False), ('properties.TRUNCATE_TABLE', ['INTEGER'], False), ('properties.MERGE', ['INTEGER'], False), ('properties.ALTER_TABLE_ADD_COLUMN', ['INTEGER'], False), ('properties.platform_type', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.$geoip_subdivision_2_name', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.ALTER_WAREHOUSE_RESUME', ['INTEGER'], False), ('properties.$lib', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.exception_type', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.$geoip_city_name', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.RENAME_USER', ['INTEGER'], False), ('properties.failed_queries', ['INTEGER'], False), ('properties.CREATE_ROLE', ['INTEGER'], False), ('properties.SELECT', ['INTEGER'], False), ('properties.BEGIN', ['INTEGER'], False), ('properties.CREATE_VIEW', ['INTEGER'], False), ('properties.is_filtered', ['BOOLEAN'], False), ('properties.open_browser', ['BOOLEAN'], False), ('properties.exception_traceback', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.run_id', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.DROP', ['INTEGER'], False), ('properties.LIST_FILES', ['INTEGER'], False), ('properties.INSERT', ['INTEGER'], False), ('properties.DROP_TASK', ['INTEGER'], False), ('properties.REMOVE_FILES', ['INTEGER'], False), ('properties.CREATE', ['INTEGER'], False), ('properties.CREATE_TABLE_AS_SELECT', ['INTEGER'], False), ('properties.role_count', ['INTEGER'], False), ('properties.CREATE_NETWORK_POLICY', ['INTEGER'], False), ('properties.depth', [], False), ('properties.ignore_schema', ['BOOLEAN'], False), ('properties.CREATE_TABLE', ['INTEGER'], False), ('properties.CREATE_CONSTRAINT', ['INTEGER'], False), ('properties.RENAME_SCHEMA', ['INTEGER'], False), ('properties.query_history_source', [], False), ('properties.exception_content', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.UPDATE', ['INTEGER'], False), ('properties.nodes_count', ['INTEGER'], False), ('properties.ALTER_USER', ['INTEGER'], False), ('properties.$set_once', ['OBJECT'], False), ('properties.user_count', ['INTEGER'], False), ('properties.export_query_history', ['BOOLEAN'], False), ('properties.edges_count', ['INTEGER'], False), ('properties.$lib_version', ['CHAR', 'VARCHAR', 'BINARY', 'DATE', 'DATE_VALUE', 'TIME', 'TIMESTAMP'], False), ('properties.queries_count', ['INTEGER'], False), ('properties.UNLOAD', ['INTEGER'], False), ('properties.DROP_TABLE', ['INTEGER'], False), ('properties.RENAME_COLUMN', ['INTEGER'], False), ('properties.ALTER_TABLE_MODIFY_COLUMN', ['INTEGER'], False), ('properties.end_date', [], False), ('properties.DROP_USER', ['INTEGER'], False), ('properties.DESCRIBE_QUERY', ['INTEGER'], False)] %}
{% set path = 'json_schema:properties:properties:$set' %}

{{json_object_schema_to_dict(table_a, path)}}